namespace Displays;

#pragma warning disable IDE0230 // Use UTF-8 string literal

public partial class Matrix5x7Unit: UserControl
{
    // 'Real' 5x7 matrix
    private static readonly Dictionary<char, byte[]> BmpStyle0 = new()
    {
        {' ', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, } },
        {'!', new byte[] { 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, 0x20, } },
        {'"', new byte[] { 0x50, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, } },
        {'#', new byte[] { 0x50, 0x50, 0xF8, 0x50, 0xF8, 0x50, 0x50, } },
        {'$', new byte[] { 0x20, 0x78, 0xA0, 0x70, 0x28, 0xF0, 0x20, } },
        {'%', new byte[] { 0xC0, 0xC8, 0x10, 0x20, 0x40, 0x98, 0x18, } },
        {'&', new byte[] { 0x40, 0xA0, 0xA0, 0x40, 0xA8, 0x90, 0x68, } },
        {'\'', new byte[] { 0x30, 0x30, 0x20, 0x40, 0x00, 0x00, 0x00, } },
        {'(', new byte[] { 0x10, 0x20, 0x40, 0x40, 0x40, 0x20, 0x10, } },
        {')', new byte[] { 0x40, 0x20, 0x10, 0x10, 0x10, 0x20, 0x40, } },
        {'*', new byte[] { 0x20, 0xA8, 0x70, 0xF8, 0x70, 0xA8, 0x20, } },
        {'+', new byte[] { 0x00, 0x20, 0x20, 0xF8, 0x20, 0x20, 0x00, } },
        {',', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, 0x20, } },
        {'-', new byte[] { 0x00, 0x00, 0x00, 0xF8, 0x00, 0x00, 0x00, } },
        {'.', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30, } },
        {'/', new byte[] { 0x00, 0x08, 0x10, 0x20, 0x40, 0x80, 0x00, } },
        {'0', new byte[] { 0x70, 0x88, 0x98, 0xA8, 0xC8, 0x88, 0x70, } },
        {'1', new byte[] { 0x20, 0x60, 0x20, 0x20, 0x20, 0x20, 0x70, } },
        {'2', new byte[] { 0x70, 0x88, 0x08, 0x10, 0x20, 0x40, 0xF8, } },
        {'3', new byte[] { 0xF8, 0x10, 0x20, 0x70, 0x08, 0x08, 0xF0, } },
        {'4', new byte[] { 0x10, 0x30, 0x50, 0x90, 0xF8, 0x10, 0x10, } },
        {'5', new byte[] { 0xF8, 0x80, 0xF0, 0x08, 0x08, 0x88, 0x70, } },
        {'6', new byte[] { 0x38, 0x40, 0x80, 0xF0, 0x88, 0x88, 0x70, } },
        {'7', new byte[] { 0xF8, 0x08, 0x08, 0x10, 0x20, 0x40, 0x80, } },
        {'8', new byte[] { 0x70, 0x88, 0x88, 0x70, 0x88, 0x88, 0x70, } },
        {'9', new byte[] { 0x70, 0x88, 0x88, 0x78, 0x08, 0x10, 0xE0, } },
        {':', new byte[] { 0x00, 0x00, 0x20, 0x00, 0x20, 0x00, 0x00, } },
        {';', new byte[] { 0x00, 0x00, 0x20, 0x00, 0x20, 0x20, 0x40, } },
        {'<', new byte[] { 0x08, 0x10, 0x20, 0x40, 0x20, 0x10, 0x08, } },
        {'=', new byte[] { 0x00, 0x00, 0xF8, 0x00, 0xF8, 0x00, 0x00, } },
        {'>', new byte[] { 0x40, 0x20, 0x10, 0x08, 0x10, 0x20, 0x40, } },
        {'?', new byte[] { 0x70, 0x88, 0x08, 0x30, 0x20, 0x00, 0x20, } },
        {'@', new byte[] { 0x70, 0x88, 0xA8, 0xB8, 0xB0, 0x80, 0x78, } },
        {'A', new byte[] { 0x20, 0x50, 0x88, 0x88, 0xF8, 0x88, 0x88, } },
        {'B', new byte[] { 0xF0, 0x88, 0x88, 0xF0, 0x88, 0x88, 0xF0, } },
        {'C', new byte[] { 0x70, 0x88, 0x80, 0x80, 0x80, 0x88, 0x70, } },
        {'D', new byte[] { 0xF0, 0x88, 0x88, 0x88, 0x88, 0x88, 0xF0, } },
        {'E', new byte[] { 0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0xF8, } },
        {'F', new byte[] { 0xF8, 0x80, 0x80, 0xF0, 0x80, 0x80, 0x80, } },
        {'G', new byte[] { 0x70, 0x88, 0x80, 0x80, 0x98, 0x88, 0x78, } },
        {'H', new byte[] { 0x88, 0x88, 0x88, 0xF8, 0x88, 0x88, 0x88, } },
        {'I', new byte[] { 0x70, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, } },
        {'J', new byte[] { 0x38, 0x10, 0x10, 0x10, 0x10, 0x90, 0x60, } },
        {'K', new byte[] { 0x88, 0x90, 0xA0, 0xC0, 0xA0, 0x90, 0x88, } },
        {'L', new byte[] { 0x80, 0x80, 0x80, 0x80, 0x80, 0x80, 0xF8, } },
        {'M', new byte[] { 0x88, 0xD8, 0xA8, 0x88, 0x88, 0x88, 0x88, } },
        {'N', new byte[] { 0x88, 0x88, 0xC8, 0xA8, 0x98, 0x88, 0x88, } },
        {'O', new byte[] { 0x70, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, } },
        {'P', new byte[] { 0xF0, 0x88, 0x88, 0xF0, 0x80, 0x80, 0x80, } },
        {'Q', new byte[] { 0x70, 0x88, 0x88, 0x88, 0xA8, 0x90, 0x68, } },
        {'R', new byte[] { 0xF0, 0x88, 0x88, 0xF0, 0xA0, 0x90, 0x88, } },
        {'S', new byte[] { 0x70, 0x88, 0x80, 0x70, 0x08, 0x88, 0x70, } },
        {'T', new byte[] { 0xF8, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, } },
        {'U', new byte[] { 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x70, } },
        {'V', new byte[] { 0x88, 0x88, 0x88, 0x88, 0x88, 0x50, 0x20, } },
        {'W', new byte[] { 0x88, 0x88, 0x88, 0xA8, 0xA8, 0xA8, 0x50, } },
        {'X', new byte[] { 0x88, 0x88, 0x50, 0x20, 0x50, 0x88, 0x88, } },
        {'Y', new byte[] { 0x88, 0x88, 0x50, 0x20, 0x20, 0x20, 0x20, } },
        {'Z', new byte[] { 0xF8, 0x08, 0x10, 0x20, 0x40, 0x80, 0xF8, } },
        {'[', new byte[] { 0x78, 0x40, 0x40, 0x40, 0x40, 0x40, 0x78, } },
        {'\\', new byte[] { 0x00, 0x80, 0x40, 0x20, 0x10, 0x08, 0x00, } },
        {']', new byte[] { 0x78, 0x08, 0x08, 0x08, 0x08, 0x08, 0x78, } },
        {'^', new byte[] { 0x20, 0x50, 0x88, 0x00, 0x00, 0x00, 0x00, } },
        {'_', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8, } },
        {'`', new byte[] { 0x60, 0x60, 0x20, 0x10, 0x00, 0x00, 0x00, } },
        {'a', new byte[] { 0x00, 0x00, 0x70, 0x08, 0x78, 0x88, 0x78, } },
        {'b', new byte[] { 0x80, 0x80, 0xF0, 0x88, 0x88, 0x88, 0xF0, } },
        {'c', new byte[] { 0x00, 0x00, 0x70, 0x88, 0x80, 0x88, 0x70, } },
        {'d', new byte[] { 0x08, 0x08, 0x78, 0x88, 0x88, 0x88, 0x78, } },
        {'e', new byte[] { 0x00, 0x00, 0x70, 0x88, 0xF8, 0x80, 0x70, } },
        {'f', new byte[] { 0x10, 0x28, 0x20, 0x70, 0x20, 0x20, 0x20, } },
        {'g', new byte[] { 0x00, 0x00, 0x70, 0x88, 0x78, 0x08, 0x70, } },
        {'h', new byte[] { 0x80, 0x80, 0xB0, 0xC8, 0x88, 0x88, 0x88, } },
        {'i', new byte[] { 0x20, 0x00, 0x60, 0x20, 0x20, 0x20, 0x70, } },
        {'j', new byte[] { 0x10, 0x00, 0x10, 0x10, 0x10, 0x90, 0x60, } },
        {'k', new byte[] { 0x80, 0x80, 0x90, 0xA0, 0xC0, 0xA0, 0x90, } },
        {'l', new byte[] { 0x60, 0x20, 0x20, 0x20, 0x20, 0x20, 0x70, } },
        {'m', new byte[] { 0x00, 0x00, 0xD0, 0xA8, 0xA8, 0xA8, 0xA8, } },
        {'n', new byte[] { 0x00, 0x00, 0xB0, 0xC8, 0x88, 0x88, 0x88, } },
        {'o', new byte[] { 0x00, 0x00, 0x70, 0x88, 0x88, 0x88, 0x70, } },
        {'p', new byte[] { 0x00, 0x00, 0xF0, 0x88, 0x88, 0xF0, 0x80, } },
        {'q', new byte[] { 0x00, 0x00, 0x78, 0x88, 0x88, 0x78, 0x08, } },
        {'r', new byte[] { 0x00, 0x00, 0xB0, 0xC8, 0x80, 0x80, 0x80, } },
        {'s', new byte[] { 0x00, 0x00, 0x78, 0x80, 0x70, 0x08, 0xF0, } },
        {'t', new byte[] { 0x40, 0x40, 0xE0, 0x40, 0x40, 0x48, 0x30, } },
        {'u', new byte[] { 0x00, 0x00, 0x88, 0x88, 0x88, 0x98, 0x68, } },
        {'v', new byte[] { 0x00, 0x00, 0x88, 0x88, 0x88, 0x50, 0x20, } },
        {'w', new byte[] { 0x00, 0x00, 0x88, 0x88, 0xA8, 0xA8, 0x50, } },
        {'x', new byte[] { 0x00, 0x00, 0x88, 0x50, 0x20, 0x50, 0x88, } },
        {'y', new byte[] { 0x00, 0x00, 0x88, 0x88, 0x78, 0x08, 0x70, } },
        {'z', new byte[] { 0x00, 0x00, 0xF8, 0x10, 0x20, 0x40, 0xF8, } },
        {'{', new byte[] { 0x10, 0x20, 0x20, 0x40, 0x20, 0x20, 0x10, } },
        {'|', new byte[] { 0x20, 0x20, 0x20, 0x00, 0x20, 0x20, 0x20, } },
        {'}', new byte[] { 0x40, 0x20, 0x20, 0x10, 0x20, 0x20, 0x40, } },
        {'~', new byte[] { 0x40, 0xA8, 0x10, 0x00, 0x00, 0x00, 0x00, } },
    };

    // Actually 4x6 matrix with descender row
    private static readonly Dictionary<char, byte[]> BmpStyle1 = new()
    {
        {' ', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, } },
        {'!', new byte[] { 0x20, 0x20, 0x20, 0x20, 0x00, 0x20, 0x00, } },
        {'"', new byte[] { 0x50, 0x50, 0x50, 0x00, 0x00, 0x00, 0x00, } },
        {'#', new byte[] { 0x00, 0x50, 0xF8, 0x50, 0xF8, 0x50, 0x00, } },
        {'$', new byte[] { 0x00, 0x70, 0xA0, 0x70, 0x28, 0x70, 0x00, } },
        {'%', new byte[] { 0x80, 0x90, 0x20, 0x40, 0x90, 0x10, 0x00, } },
        {'&', new byte[] { 0x00, 0x40, 0xA0, 0x40, 0xA0, 0x50, 0x00, } },
        {'\'', new byte[] { 0x20, 0x20, 0x20, 0x00, 0x00, 0x00, 0x00, } },
        {'(', new byte[] { 0x20, 0x40, 0x40, 0x40, 0x40, 0x20, 0x00, } },
        {')', new byte[] { 0x40, 0x20, 0x20, 0x20, 0x20, 0x40, 0x00, } },
        {'*', new byte[] { 0x00, 0x50, 0x20, 0x70, 0x20, 0x50, 0x00, } },
        {'+', new byte[] { 0x00, 0x20, 0x20, 0xF8, 0x20, 0x20, 0x00, } },
        {',', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x30, 0x20, 0x40, } },
        {'-', new byte[] { 0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00, } },
        {'.', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x60, 0x60, 0x00, } },
        {'/', new byte[] { 0x00, 0x10, 0x20, 0x40, 0x80, 0x00, 0x00, } },
        {'0', new byte[] { 0x20, 0x50, 0x50, 0x50, 0x50, 0x20, 0x00, } },
        {'1', new byte[] { 0x20, 0x60, 0x20, 0x20, 0x20, 0x70, 0x00, } },
        {'2', new byte[] { 0x60, 0x90, 0x10, 0x20, 0x40, 0xF0, 0x00, } },
        {'3', new byte[] { 0xF0, 0x10, 0x60, 0x10, 0x90, 0x60, 0x00, } },
        {'4', new byte[] { 0x20, 0x60, 0xA0, 0xF0, 0x20, 0x20, 0x00, } },
        {'5', new byte[] { 0xF0, 0x80, 0xE0, 0x10, 0x90, 0x60, 0x00, } },
        {'6', new byte[] { 0x60, 0x80, 0xE0, 0x90, 0x90, 0x60, 0x00, } },
        {'7', new byte[] { 0xF0, 0x10, 0x20, 0x20, 0x40, 0x40, 0x00, } },
        {'8', new byte[] { 0x60, 0x90, 0x60, 0x90, 0x90, 0x60, 0x00, } },
        {'9', new byte[] { 0x60, 0x90, 0x90, 0x70, 0x10, 0x60, 0x00, } },
        {':', new byte[] { 0x00, 0x60, 0x60, 0x00, 0x60, 0x60, 0x00, } },
        {';', new byte[] { 0x00, 0x60, 0x60, 0x00, 0x60, 0x40, 0x80, } },
        {'<', new byte[] { 0x00, 0x10, 0x20, 0x40, 0x20, 0x10, 0x00, } },
        {'=', new byte[] { 0x00, 0x00, 0xF0, 0x00, 0xF0, 0x00, 0x00, } },
        {'>', new byte[] { 0x00, 0x40, 0x20, 0x10, 0x20, 0x40, 0x00, } },
        {'?', new byte[] { 0x20, 0x50, 0x10, 0x20, 0x00, 0x20, 0x00, } },
        {'@', new byte[] { 0x60, 0x90, 0xB0, 0xB0, 0x80, 0x60, 0x00, } },
        {'A', new byte[] { 0x60, 0x90, 0x90, 0xF0, 0x90, 0x90, 0x00, } },
        {'B', new byte[] { 0xE0, 0x90, 0xE0, 0x90, 0x90, 0xE0, 0x00, } },
        {'C', new byte[] { 0x60, 0x90, 0x80, 0x80, 0x90, 0x60, 0x00, } },
        {'D', new byte[] { 0xE0, 0x90, 0x90, 0x90, 0x90, 0xE0, 0x00, } },
        {'E', new byte[] { 0xF0, 0x80, 0xE0, 0x80, 0x80, 0xF0, 0x00, } },
        {'F', new byte[] { 0xF0, 0x80, 0xE0, 0x80, 0x80, 0x80, 0x00, } },
        {'G', new byte[] { 0x60, 0x90, 0x80, 0xB0, 0x90, 0x70, 0x00, } },
        {'H', new byte[] { 0x90, 0x90, 0xF0, 0x90, 0x90, 0x90, 0x00, } },
        {'I', new byte[] { 0x70, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00, } },
        {'J', new byte[] { 0x10, 0x10, 0x10, 0x10, 0x90, 0x60, 0x00, } },
        {'K', new byte[] { 0x90, 0xA0, 0xC0, 0xC0, 0xA0, 0x90, 0x00, } },
        {'L', new byte[] { 0x80, 0x80, 0x80, 0x80, 0x80, 0xF0, 0x00, } },
        {'M', new byte[] { 0x90, 0xF0, 0xF0, 0x90, 0x90, 0x90, 0x00, } },
        {'N', new byte[] { 0x90, 0xD0, 0xD0, 0xB0, 0xB0, 0x90, 0x00, } },
        {'O', new byte[] { 0x60, 0x90, 0x90, 0x90, 0x90, 0x60, 0x00, } },
        {'P', new byte[] { 0xE0, 0x90, 0x90, 0xE0, 0x80, 0x80, 0x00, } },
        {'Q', new byte[] { 0x60, 0x90, 0x90, 0x90, 0xD0, 0x60, 0x10, } },
        {'R', new byte[] { 0xE0, 0x90, 0x90, 0xE0, 0xA0, 0x90, 0x00, } },
        {'S', new byte[] { 0x60, 0x90, 0x40, 0x20, 0x90, 0x60, 0x00, } },
        {'T', new byte[] { 0x70, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, } },
        {'U', new byte[] { 0x90, 0x90, 0x90, 0x90, 0x90, 0x60, 0x00, } },
        {'V', new byte[] { 0x90, 0x90, 0x90, 0x90, 0x60, 0x60, 0x00, } },
        {'W', new byte[] { 0x90, 0x90, 0x90, 0xF0, 0xF0, 0x90, 0x00, } },
        {'X', new byte[] { 0x90, 0x90, 0x60, 0x60, 0x90, 0x90, 0x00, } },
        {'Y', new byte[] { 0x50, 0x50, 0x50, 0x20, 0x20, 0x20, 0x00, } },
        {'Z', new byte[] { 0xF0, 0x10, 0x20, 0x40, 0x80, 0xF0, 0x00, } },
        {'[', new byte[] { 0x70, 0x40, 0x40, 0x40, 0x40, 0x70, 0x00, } },
        {'\\', new byte[] { 0x00, 0x80, 0x40, 0x20, 0x10, 0x00, 0x00, } },
        {']', new byte[] { 0x70, 0x10, 0x10, 0x10, 0x10, 0x70, 0x00, } },
        {'^', new byte[] { 0x20, 0x50, 0x00, 0x00, 0x00, 0x00, 0x00, } },
        {'_', new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0, 0x00, } },
        {'`', new byte[] { 0x40, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, } },
        {'a', new byte[] { 0x00, 0x00, 0x70, 0x90, 0xB0, 0x50, 0x00, } },
        {'b', new byte[] { 0x80, 0x80, 0xE0, 0x90, 0x90, 0xE0, 0x00, } },
        {'c', new byte[] { 0x00, 0x00, 0x60, 0x80, 0x80, 0x60, 0x00, } },
        {'d', new byte[] { 0x10, 0x10, 0x70, 0x90, 0x90, 0x70, 0x00, } },
        {'e', new byte[] { 0x00, 0x00, 0x60, 0xB0, 0xC0, 0x60, 0x00, } },
        {'f', new byte[] { 0x20, 0x50, 0x40, 0xE0, 0x40, 0x40, 0x00, } },
        {'g', new byte[] { 0x00, 0x00, 0x70, 0x90, 0x60, 0x80, 0x70, } },
        {'h', new byte[] { 0x80, 0x80, 0xE0, 0x90, 0x90, 0x90, 0x00, } },
        {'i', new byte[] { 0x20, 0x00, 0x60, 0x20, 0x20, 0x70, 0x00, } },
        {'j', new byte[] { 0x10, 0x00, 0x10, 0x10, 0x10, 0x50, 0x20, } },
        {'k', new byte[] { 0x80, 0x80, 0xA0, 0xC0, 0xA0, 0x90, 0x00, } },
        {'l', new byte[] { 0x60, 0x20, 0x20, 0x20, 0x20, 0x70, 0x00, } },
        {'m', new byte[] { 0x00, 0x00, 0xA0, 0xF0, 0x90, 0x90, 0x00, } },
        {'n', new byte[] { 0x00, 0x00, 0xE0, 0x90, 0x90, 0x90, 0x00, } },
        {'o', new byte[] { 0x00, 0x00, 0x60, 0x90, 0x90, 0x60, 0x00, } },
        {'p', new byte[] { 0x00, 0x00, 0xE0, 0x90, 0x90, 0xE0, 0x80, } },
        {'q', new byte[] { 0x00, 0x00, 0x70, 0x90, 0x90, 0x70, 0x10, } },
        {'r', new byte[] { 0x00, 0x00, 0xE0, 0x90, 0x80, 0x80, 0x00, } },
        {'s', new byte[] { 0x00, 0x00, 0x70, 0xC0, 0x30, 0xE0, 0x00, } },
        {'t', new byte[] { 0x40, 0x40, 0xE0, 0x40, 0x40, 0x30, 0x00, } },
        {'u', new byte[] { 0x00, 0x00, 0x90, 0x90, 0x90, 0x70, 0x00, } },
        {'v', new byte[] { 0x00, 0x00, 0x50, 0x50, 0x50, 0x20, 0x00, } },
        {'w', new byte[] { 0x00, 0x00, 0x90, 0x90, 0xF0, 0xF0, 0x00, } },
        {'x', new byte[] { 0x00, 0x00, 0x90, 0x60, 0x60, 0x90, 0x00, } },
        {'y', new byte[] { 0x00, 0x00, 0x90, 0x90, 0x50, 0x20, 0x40, } },
        {'z', new byte[] { 0x00, 0x00, 0xF0, 0x20, 0x40, 0xF0, 0x00, } },
        {'{', new byte[] { 0x10, 0x20, 0x60, 0x20, 0x20, 0x10, 0x00, } },
        {'|', new byte[] { 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x00, } },
        {'}', new byte[] { 0x40, 0x20, 0x30, 0x20, 0x20, 0x40, 0x00, } },
        {'~', new byte[] { 0x50, 0xA0, 0x00, 0x00, 0x00, 0x00, 0x00, } },
    };

    private readonly Rectangle[,] dots = new Rectangle[7, 5];

    public Matrix5x7Unit()
    {
        InitializeComponent();
        for (int row = 0; row < 7; row++)
            for (int col = 0; col < 5; col++)
            {
                var dot = new Rectangle
                {
                    Fill = Brushes.Black,
                    Opacity = 0.1,
                    Margin = new Thickness(0.15),
                };
                Grid.SetRow(dot, row);
                Grid.SetColumn(dot, col);
                DotMatrixGrid.Children.Add(dot);
                dots[row, col] = dot;
            }
    }

    // ----

    public static readonly DependencyProperty SymbolProperty =
        DependencyProperty.Register("Symbol", typeof(char), typeof(Matrix5x7Unit),
        new PropertyMetadata(' ', new PropertyChangedCallback(OnSymbolChanged)));

    public char Symbol
    {
        get => (char)GetValue(SymbolProperty);
        set => SetValue(SymbolProperty, value);
    }

    private static void OnSymbolChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        => ((Matrix5x7Unit)d).UpdateDisplay();

    // ----

    public static readonly DependencyProperty VariantProperty =
        DependencyProperty.Register("Variant", typeof(int), typeof(Matrix5x7Unit),
        new PropertyMetadata(0, new PropertyChangedCallback(OnVariantChanged)));

    public int Variant
    {
        get => (int)GetValue(VariantProperty);
        set => SetValue(VariantProperty, value);
    }

    private static void OnVariantChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        => ((Matrix5x7Unit)d).UpdateDisplay();

    // ----

    private void UpdateDisplay()
    {
        Dictionary<char, byte[]> Bmp = Variant == 1 ? BmpStyle1 : BmpStyle0;
        if (Bmp.TryGetValue(Symbol, out byte[]? bits))
        {
            for (int row = 0; row < 7; row++)
                for (int col = 0; col < 5; col++)
                    dots[row, col].Opacity = ((bits[row] & (1 << (7 - col))) != 0) ? 1.0 : 0.1;
        }
        else
        {
            // Hide all if character not found
            for (int row = 0; row < 7; row++)
                for (int col = 0; col < 5; col++)
                    dots[row, col].Opacity = 0.1;
        }
    }
}
